<?xml version="1.0" encoding="UTF-8"?>
<!--
  ~ Licensed to the Apache Software Foundation (ASF) under one or more
  ~ contributor license agreements.  See the NOTICE file distributed with
  ~ this work for additional information regarding copyright ownership.
  ~ The ASF licenses this file to you under the Apache License, Version 2.0
  ~ (the "License"); you may not use this file except in compliance with
  ~ the License.  You may obtain a copy of the License at
  ~
  ~ http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->
<Configuration>
  <Properties>
    <!-- Log file goes to test-logs under working directory (which is build/) -->
    <Property name="logDir">${sys:user.dir}/test-logs</Property>
  </Properties>
  <Appenders>
    <Console name="A1" target="SYSTEM_OUT">
      <PatternLayout
          pattern="%d [%t] %-5p %c - %m%n"/>
    </Console>
    <!-- File appender for persistent test logs -->
    <RollingFile name="TestLog" fileName="${logDir}/govdata-test.log"
                 filePattern="${logDir}/govdata-test-%d{yyyy-MM-dd}-%i.log.gz">
      <PatternLayout pattern="%d [%t] %-5p %c - %m%n"/>
      <Policies>
        <SizeBasedTriggeringPolicy size="50MB"/>
      </Policies>
      <DefaultRolloverStrategy max="3"/>
    </RollingFile>
  </Appenders>

  <Loggers>
    <Root level="INFO">
      <AppenderRef ref="A1"/>
      <AppenderRef ref="TestLog"/>
    </Root>
    <!-- Silence ERROR logs from CalciteException, SqlValidatorException during tests -->
    <logger name="org.apache.calcite.runtime.CalciteException" level="FATAL"/>
    <logger name="org.apache.calcite.sql.validate.SqlValidatorException" level="ERROR"/>
    <logger name="org.apache.calcite.plan.RexImplicationChecker" level="FATAL"/>
    <logger name="org.apache.calcite.test.SqlOperatorTest" level="FATAL"/>
    <!-- Silence anything but errors -->
    <logger name="org.apache.calcite.plan.VisitorDataContext" level="ERROR"/>
    <logger name="org.apache.calcite.avatica" level="ERROR"/>
    <logger name="org.eclipse.jetty" level="ERROR"/>
    <logger name="org.apache.calcite.sql.parser" level="ERROR"/>
    <logger name="org.apache.calcite.plan.RelOptPlanner" level="ERROR">
      <MarkerFilter marker="FULL_PLAN" onMatch="DENY" onMismatch="NEUTRAL"/>
    </logger>
    <logger name="org.apache.calcite.rel.rules.DpHyp" level="ERROR"/>
    <!-- SEC adapter specific logging -->
    <logger name="org.apache.calcite.adapter.sec.SecSchemaFactory" level="DEBUG"/>
    <logger name="org.apache.calcite.adapter.sec.SecSchema" level="DEBUG"/>
    <logger name="org.apache.calcite.adapter.sec.EdgarDownloader" level="DEBUG"/>
    <logger name="org.apache.calcite.adapter.sec.CikRegistry" level="DEBUG"/>
    <logger name="org.apache.calcite.adapter.sec.SecToParquetConverter" level="DEBUG"/>
    <logger name="org.apache.calcite.adapter.sec" level="INFO"/>
    <!-- Also enable file adapter logging since SEC extends it -->
    <logger name="org.apache.calcite.adapter.file.FileSchemaFactory" level="DEBUG"/>
    <logger name="org.apache.calcite.adapter.file.FileSchema" level="DEBUG"/>
    <logger name="org.apache.calcite.adapter.file.table.PartitionedParquetTable" level="DEBUG"/>
    <logger name="org.apache.calcite.adapter.file.refresh.RefreshablePartitionedParquetTable" level="ERROR"/>
    <!-- Enable debug logging for alternate partition selection and HLL optimization rules -->
    <logger name="org.apache.calcite.adapter.file.rules.AlternatePartitionSelectionRule" level="DEBUG"/>
    <logger name="org.apache.calcite.adapter.file.duckdb.DuckDBHLLCountDistinctRule" level="DEBUG"/>
    <logger name="org.apache.calcite.adapter.file.duckdb.DuckDBIcebergCountStarRule" level="DEBUG"/>
    <logger name="org.apache.calcite.adapter.file.duckdb.DuckDBConvention" level="DEBUG"/>
    <logger name="org.apache.calcite.adapter.file.rules.CountStarStatisticsRule" level="DEBUG"/>
    <!-- Enable debug logging for BeaDataDownloader to see API responses -->
    <logger name="org.apache.calcite.adapter.govdata.econ.BeaDataDownloader" level="DEBUG"/>
    <!-- Enable debug logging for S3 storage to see exists() checks -->
    <logger name="org.apache.calcite.adapter.file.storage.S3StorageProvider" level="DEBUG"/>
    <!-- Enable debug logging for govdata package (includes AbstractGovDataDownloader) -->
    <logger name="org.apache.calcite.adapter.govdata" level="DEBUG"/>
    <logger name="org.apache.calcite.adapter.govdata.econ" level="DEBUG"/>
    <!-- Enable debug logging for ETL pipeline to see rawCache config -->
    <logger name="org.apache.calcite.adapter.file.etl" level="DEBUG"/>
    <logger name="org.apache.calcite.adapter.file.etl.EtlPipeline" level="DEBUG"/>
    <logger name="org.apache.calcite.adapter.file.etl.HttpSource" level="DEBUG"/>
  </Loggers>
</Configuration>
